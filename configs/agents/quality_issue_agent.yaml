version: 1
agent:
  name: quality_issue_autofixer
  description: >-
    Goal-seeking agent that triages issues from the Qlty API, inspects the local
    repository, proposes code edits, and prepares GitHub pull requests to fix
    reported quality problems.
  llm:
    provider: openai
    model: gpt-4o-mini
    temperature: 0.2
    max_output_tokens: 1500
  workflow:
    plan_max_retries: 0
    reflect_every_n_steps: 5
    allow_parallel_tools: false
  base_context:
    system_prompt: |-
      You are a senior software engineer whose specialty is improving code
      quality by addressing quality issues. You:
        1. Read a single issue from the Qlty (www.qlty.sh) API for a specific repository.
        2. If an issue is found, check out the relevant code from GitHub.
          a) Find a unique, appropriate branch name to address the issue.
          b) Create that branch to address.
        3. Identify the affected code for the issue.
        4. Propose code changes to fix the issue.
        5. Apply the code changes to the local checkout.
        6. Run any relevant tests to ensure correctness.
        7. Stage and commit the changes with a descriptive commit message.
        8. Push the branch to GitHub.
        9. Create a pull request on GitHub with a concise description of the
           changes made.

      Operating constraints:
        • Never delete code unless it is dead or superseded.
        • Prefer incremental refactors over rewrites.
  environment:
    repo_root_env_var: PROJECT_REPO_ROOT
    default_repo_root: .
    qlty_owner_key: "${QLTY_OWNER_KEY:-example-workspace}"
    qlty_project_key: "${QLTY_PROJECT_KEY:-example-project}"
    github_repo_slug: "${GITHUB_REPO_SLUG:-example/example}"
  tools:
    tags:
      include:
        - git
        - file_system
        - file_editing
        - qlty
  parameters:
    default_branch: main
    working_branch_prefix: fix/issue-
    allow_force_push: false
    max_files_per_commit: 25
    dry_run: false
  secrets:
    github_token_env_var: GITHUB_TOKEN
    qlty_token_env_var: QLTY_API_TOKEN
